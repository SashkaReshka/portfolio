<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>GPT ‚Äî –û–ª–µ–∫—Å–∞–Ω–¥—Ä</title>
  <meta name="description" content="Custom GPT –∞—Å–∏—Å—Ç–µ–Ω—Ç">
  <meta name="color-scheme" content="light dark" />
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="css/gpts-styles.css">
</head>
<body>
  <div class="layout">
    <aside id="navigation"></aside>

    <main>
      <!-- üß≠ –•–ª—ñ–±–Ω—ñ –∫—Ä–∏—Ö—Ç–∏ -->
      <div id="breadcrumbs-container" style="max-width:1100px; margin:0 auto; padding:0 40px;"></div>

      <div class="container">
        <article id="gpt-content" class="section">
          <div class="loading-state">
            <div class="spinner"></div>
            <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</p>
          </div>
        </article>
      </div>
    </main>
  </div>

  <script src="js/utils.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/nav.js"></script>
  <script src="js/breadcrumbs.js"></script>

  <script>
    // –û—Ç—Ä–∏–º—É—î–º–æ slug –∑ URL
    const urlParams = new URLSearchParams(window.location.search);
    const gptSlug = urlParams.get('gpt');

    document.addEventListener('DOMContentLoaded', async () => {
      if (!gptSlug) {
        showError('GPT –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. <a href="gpts.html">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É</a>');
        return;
      }

      try {
        const response = await fetch('data/gpts.json');
        if (!response.ok) throw new Error('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –¥–∞–Ω—ñ');
        
        const gpts = await response.json();
        const gpt = gpts.find(p => p.slug === gptSlug);
        
        if (!gpt) {
          showError('GPT –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ. <a href="gpts.html">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É</a>');
          return;
        }
        
        renderGpt(gpt);
        updateMetaTags(gpt);

        // üß≠ –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î–º–æ —Ö–ª—ñ–±–Ω—ñ –∫—Ä–∏—Ö—Ç–∏
        if (window.initBreadcrumbs) {
          window.initBreadcrumbs({
            currentPage: gpt.title,
            parentPage: 'GPTs Lab',
            parentUrl: 'gpts.html'
          });
        }

      } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞:', error);
        showError('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è GPT. <a href="gpts.html">–ü–æ–≤–µ—Ä–Ω—É—Ç–∏—Å—è –¥–æ —Å–ø–∏—Å–∫—É</a>');
      }
    });

    function renderGpt(gpt) {
      const container = document.getElementById('gpt-content');
      const tagsHTML = gpt.tags?.length 
        ? gpt.tags.map(tag => `<a href="gpts.html?tag=${tag}" class="chip">#${tag}</a>`).join(' ')
        : '';
      
      container.innerHTML = `
        <div style="text-align: center; margin-bottom: 2rem;">
          <div style="font-size: 80px; line-height: 1; margin-bottom: 1rem;">${gpt.icon}</div>
          <h1>${gpt.title}</h1>
          <p class="meta" style="font-size: 18px; margin: 16px 0;">${gpt.description}</p>
          ${tagsHTML ? `<div style="margin: 16px 0;">${tagsHTML}</div>` : ''}
          ${gpt.featured ? '<div class="meta" style="color: var(--accent); font-weight: 600; margin-top: 8px;">‚≠ê –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ</div>' : ''}
          <div style="margin-top: 24px;">
            <a href="${gpt.link}" class="btn btn-accent" target="_blank" rel="noopener" style="font-size: 16px; padding: 12px 32px;">
              üöÄ –°–ø—Ä–æ–±—É–≤–∞—Ç–∏ GPT
            </a>
          </div>
        </div>
        <div class="content" style="margin-top: 3rem;">${gpt.content}</div>
        <div style="margin-top: 3rem; padding-top: 2rem; border-top: 1px solid var(--border); text-align: center;">
          <a href="gpts.html" class="btn">‚Üê –ù–∞–∑–∞–¥ –¥–æ —Å–ø–∏—Å–∫—É</a>
        </div>
      `;
    }

    function updateMetaTags(gpt) {
      document.title = `${gpt.title} ‚Äî GPTs Lab ‚Äî –û–ª–µ–∫—Å–∞–Ω–¥—Ä`;
      let metaDescription = document.querySelector('meta[name="description"]');
      if (!metaDescription) {
        metaDescription = document.createElement('meta');
        metaDescription.name = 'description';
        document.head.appendChild(metaDescription);
      }
      metaDescription.content = gpt.description;
    }

    function showError(message) {
      document.getElementById('gpt-content').innerHTML = `
        <div class="error-message" style="text-align: center; padding: 3rem 1rem;">
          <p style="font-size: 18px;">‚ùå ${message}</p>
        </div>
      `;
    }
  </script>
</body>
</html>
