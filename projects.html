<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Interactive Lab ‚Äî –û–ª–µ–∫—Å–∞–Ω–¥—Ä</title>
  <meta name="description" content="–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∏ —Ç–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—ñ–≤">
  <meta name="color-scheme" content="light dark" />
  <link rel="stylesheet" href="css/base.css" />
<link rel="stylesheet" href="css/navigation.css" />
<link rel="stylesheet" href="css/components.css" />
<link rel="stylesheet" href="css/sections.css" />
<link rel="stylesheet" href="css/mobile.css" />
</head>
<body>
  <div class="layout">
    <aside id="navigation"></aside>

    <main>
      <!-- üß≠ –•–ª—ñ–±–Ω—ñ –∫—Ä–∏—Ö—Ç–∏ –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É -->
      <div id="breadcrumbs-container"></div>

      <div class="container">
        <section class="section">
          <h1>üß™ Interactive Lab</h1>
          <p class="meta">–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∏ —Ç–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—ñ–æ–Ω–∞–ª—ñ–≤</p>
          
          <!-- –ü–æ—à—É–∫ —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∏ -->
          <div class="search-filters">
            <!-- –ü–æ—à—É–∫ -->
            <div class="search-box">
              <input 
                type="search" 
                id="search-input" 
                class="search-field" 
                placeholder="üîç –ü–æ—à—É–∫ –ø—Ä–æ—î–∫—Ç—ñ–≤..."
                aria-label="–ü–æ—à—É–∫ –ø—Ä–æ—î–∫—Ç—ñ–≤"
              />
            </div>
            
            <!-- –§—ñ–ª—å—Ç—Ä–∏ –ø–æ —Ç–µ–≥–∞—Ö -->
            <div class="filter-tags" id="filter-tags">
              <button class="filter-tag active" data-tag="all" onclick="filterByTag('all')">
                –í—Å—ñ
              </button>
              <!-- –Ü–Ω—à—ñ —Ç–µ–≥–∏ –¥–æ–¥–∞–¥—É—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
          </div>
          
          <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ -->
          <div class="results-info" id="results-info">
            –ü–æ–∫–∞–∑–∞–Ω–æ: <strong id="results-count">0</strong> –ø—Ä–æ—î–∫—Ç—ñ–≤
          </div>
          
          <!-- –°—ñ—Ç–∫–∞ –ø—Ä–æ—î–∫—Ç—ñ–≤ -->
          <div id="projects-grid" class="grid cols-3">
            <div class="loading-state">
              <div class="spinner"></div>
              <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤...</p>
            </div>
          </div>
          
          <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ -->
          <div id="no-results" class="no-results" style="display: none;">
            <h3>üòî –ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h3>
            <p>–°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à–∏–π –∑–∞–ø–∏—Ç –∞–±–æ –æ–±–µ—Ä—ñ—Ç—å —ñ–Ω—à–∏–π —Ç–µ–≥</p>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script src="js/utils.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/nav.js"></script>
  <!-- üß≠ breadcrumbs -->
  <script src="js/breadcrumbs.js"></script>
  <script>
    // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è breadcrumbs –¥–ª—è —Ä–æ–∑–¥—ñ–ª—É
    document.addEventListener('DOMContentLoaded', () => {
      if (window.initBreadcrumbs) window.initBreadcrumbs();
    });
  </script>

  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
    let allProjects = [];
    let currentTag = 'all';
    let currentSearch = '';
    
    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤
    async function loadAllProjects() {
      try {
        const response = await fetch('data/projects/index.json');
        allProjects = await response.json();
        
        // –°–æ—Ä—Ç—É—î–º–æ: —Å–ø–æ—á–∞—Ç–∫—É featured, –ø–æ—Ç—ñ–º –∑–∞ –¥–∞—Ç–æ—é
        allProjects.sort((a, b) => {
          if (a.featured && !b.featured) return -1;
          if (!a.featured && b.featured) return 1;
          return new Date(b.date) - new Date(a.date);
        });
        
        // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–æ —Ç–µ–≥–∞—Ö
        generateTagFilters();
        
        // –ü–æ–∫–∞–∑—É—î–º–æ –ø—Ä–æ—î–∫—Ç–∏
        displayProjects();
        
        // –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –ø–æ—à—É–∫
        setupSearch();
        
      } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤:', error);
        document.getElementById('projects-grid').innerHTML = `
          <div class="error-message">
            <p>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç–∏</p>
          </div>
        `;
      }
    }
    
    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–Ω–æ–ø–æ–∫ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ –ø–æ —Ç–µ–≥–∞—Ö
    function generateTagFilters() {
      const tags = window.utils.getAllTags(allProjects);
      const container = document.getElementById('filter-tags');
      
      // –ö–Ω–æ–ø–∫–∞ "–í—Å—ñ" –≤–∂–µ —î –≤ HTML
      
      // –î–æ–¥–∞—î–º–æ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–µ–≥—É
      tags.forEach(tag => {
        const button = document.createElement('button');
        button.className = 'filter-tag';
        button.dataset.tag = tag;
        button.textContent = tag;
        button.onclick = () => filterByTag(tag);
        container.appendChild(button);
      });
    }
    
    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Ç–µ–≥—É
    function filterByTag(tag) {
      currentTag = tag;
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –∞–∫—Ç–∏–≤–Ω—É –∫–Ω–æ–ø–∫—É
      document.querySelectorAll('.filter-tag').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tag === tag);
      });
      
      displayProjects();
    }
    
    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—à—É–∫—É
    function setupSearch() {
      const searchInput = document.getElementById('search-input');
      
      // –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ debounce –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
      const debouncedSearch = window.utils.debounce((query) => {
        currentSearch = query;
        
        // –Ø–∫—â–æ —î –ø–æ—à—É–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç ‚Äî —Å–∫–∏–¥–∞—î–º–æ —Ñ—ñ–ª—å—Ç—Ä —Ç–µ–≥—ñ–≤ –Ω–∞ "–í—Å—ñ"
        if (query.trim() !== '') {
          currentTag = 'all';
          document.querySelectorAll('.filter-tag').forEach(btn => {
            btn.classList.toggle('active', btn.dataset.tag === 'all');
          });
        }
        
        displayProjects();
      }, 300);
      
      searchInput.addEventListener('input', (e) => {
        debouncedSearch(e.target.value);
      });
    }
    
    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é
    function displayProjects() {
      const grid = document.getElementById('projects-grid');
      const noResults = document.getElementById('no-results');
      const resultsCount = document.getElementById('results-count');
      
      // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –ø–æ —Ç–µ–≥—É
      let filteredProjects = currentTag === 'all' 
        ? allProjects 
        : window.utils.filterByTag(allProjects, currentTag);
      
      // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –ø–æ –ø–æ—à—É–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Ç—É
      if (currentSearch) {
        filteredProjects = window.utils.searchItems(
          filteredProjects, 
          currentSearch,
          ['title', 'description', 'tags', 'role']
        );
      }
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫
      resultsCount.textContent = filteredProjects.length;
      
      // –Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
      if (filteredProjects.length === 0) {
        grid.style.display = 'none';
        noResults.style.display = 'block';
        return;
      }
      
      // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
      grid.style.display = 'grid';
      noResults.style.display = 'none';
      grid.innerHTML = '';
      
      filteredProjects.forEach(project => {
        const card = document.createElement('a');
        card.className = 'card' + (project.featured ? ' featured' : '');
        card.href = `project.html?project=${project.slug}`;
        
        card.innerHTML = `
          <div class="thumb" style="display: flex; align-items: center; justify-content: center; font-size: 60px; background: var(--card-bg);">
            ${getProjectIcon(project.tags)}
          </div>
          <div class="card-body">
            <h3>${highlightText(project.title, currentSearch)}</h3>
            ${project.featured ? '<div class="meta" style="color: var(--accent); font-weight: 600;">‚≠ê –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ</div>' : ''}
            <div class="meta">${project.role}</div>
            <p style="margin: 8px 0 0; color: var(--muted); font-size: 14px;">
              ${highlightText(project.description, currentSearch)}
            </p>
            ${project.tags && project.tags.length > 0 ? 
              `<div class="tags" style="margin-top: 12px;">
                ${project.tags.slice(0, 3).map(tag => `<span class="chip">#${tag}</span>`).join(' ')}
              </div>` : 
              ''
            }
          </div>
        `;
        
        grid.appendChild(card);
      });
    }
    
    // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –≤–∏–±–æ—Ä—É —ñ–∫–æ–Ω–∫–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–µ–≥—ñ–≤ –ø—Ä–æ—î–∫—Ç—É
    function getProjectIcon(tags) {
      if (!tags || tags.length === 0) return 'üîß';
      
      // –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç —ñ–∫–æ–Ω–æ–∫ –∑–∞ —Ç–µ–≥–∞–º–∏
      const iconMap = {
        'CCTV': 'üìπ',
        'Camera': 'üìπ',
        'Video': 'üìπ',
        'Energy': '‚ö°',
        'Solar': '‚òÄÔ∏è',
        'Battery': 'üîã',
        'Calculator': 'üßÆ',
        'Network': 'üåê',
        'PoE': 'üîå',
        'Web': 'üåê',
        'Design': 'üé®',
        'Portfolio': 'üíº',
        'JavaScript': '‚öôÔ∏è',
        'WebWorkers': '‚öôÔ∏è'
      };
      
      // –®—É–∫–∞—î–º–æ –ø–µ—Ä—à—É –ø—ñ–¥—Ö–æ–¥—è—â—É —ñ–∫–æ–Ω–∫—É
      for (const tag of tags) {
        if (iconMap[tag]) {
          return iconMap[tag];
        }
      }
      
      // –Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø—ñ–¥—ñ–π—à–ª–æ ‚Äî –¥–µ—Ñ–æ–ª—Ç–Ω–∞ —ñ–∫–æ–Ω–∫–∞
      return 'üîß';
    }
    
    // –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∑–Ω–∞–π–¥–µ–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É
    function highlightText(text, query) {
      if (!query || query.trim() === '') return text;
      
      const regex = new RegExp(`(${query})`, 'gi');
      return text.replace(regex, '<mark>$1</mark>');
    }
    
    // –ó–∞–ø—É—Å–∫
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadAllProjects);
    } else {
      loadAllProjects();
    }
  </script>
</body>
</html>