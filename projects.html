<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ü—Ä–æ—î–∫—Ç–∏ ‚Äî –û–ª–µ–∫—Å–∞–Ω–¥—Ä</title>
  <meta name="description" content="–ü–æ—Ä—Ç—Ñ–æ–ª—ñ–æ –ø—Ä–æ—î–∫—Ç—ñ–≤: –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∏, –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∏, —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏">
  <meta name="color-scheme" content="light dark" />
  <link rel="stylesheet" href="css/main.css" />
  <link rel="stylesheet" href="css/gpts-styles.css">
</head>
<body>
  <div class="layout">
    <aside id="navigation"></aside>

    <main>
      <div class="container">
        <section class="section">
          <h1>–ü—Ä–æ—î–∫—Ç–∏</h1>
          <p class="meta">–Ü–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∏ —Ç–∞ –≤–µ–±-–¥–æ–¥–∞—Ç–∫–∏ –¥–ª—è B2B-–∫–ª—ñ—î–Ω—Ç—ñ–≤</p>
          
          <!-- –ü–æ—à—É–∫ —Ç–∞ —Ñ—ñ–ª—å—Ç—Ä–∏ -->
          <div class="search-filters">
            <!-- –ü–æ—à—É–∫ -->
            <div class="search-box">
              <input 
                type="search" 
                id="search-input" 
                class="search-field" 
                placeholder="üîç –ü–æ—à—É–∫ –ø—Ä–æ—î–∫—Ç—ñ–≤..."
                aria-label="–ü–æ—à—É–∫ –ø—Ä–æ—î–∫—Ç—ñ–≤"
              />
            </div>
            
            <!-- –§—ñ–ª—å—Ç—Ä–∏ –ø–æ —Ç–µ–≥–∞—Ö -->
            <div class="filter-tags" id="filter-tags">
              <button class="filter-tag active" data-tag="all" onclick="filterByTag('all')">
                –í—Å—ñ
              </button>
              <!-- –Ü–Ω—à—ñ —Ç–µ–≥–∏ –¥–æ–¥–∞–¥—É—Ç—å—Å—è —á–µ—Ä–µ–∑ JS -->
            </div>
          </div>
          
          <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ -->
          <div class="results-info" id="results-info">
            –ü–æ–∫–∞–∑–∞–Ω–æ: <strong id="results-count">0</strong> –ø—Ä–æ—î–∫—Ç—ñ–≤
          </div>
          
          <!-- –°—ñ—Ç–∫–∞ –ø—Ä–æ—î–∫—Ç—ñ–≤ -->
          <div id="projects-grid" class="grid cols-3">
            <div class="loading-state">
              <div class="spinner"></div>
              <p>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤...</p>
            </div>
          </div>
          
          <!-- –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —è–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ -->
          <div id="no-results" class="no-results" style="display: none;">
            <h3>üòî –ù—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ</h3>
            <p>–°–ø—Ä–æ–±—É–π—Ç–µ —ñ–Ω—à–∏–π –∑–∞–ø–∏—Ç –∞–±–æ –æ–±–µ—Ä—ñ—Ç—å —ñ–Ω—à–∏–π —Ç–µ–≥</p>
          </div>
        </section>
      </div>
    </main>
  </div>

  <script src="js/utils.js"></script>
  <script src="js/theme.js"></script>
  <script src="js/nav.js"></script>
  
  <script>
    // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
    let allProjects = [];
    let currentTag = 'all';
    let currentSearch = '';
    
    // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –≤—Å—ñ—Ö –ø—Ä–æ—î–∫—Ç—ñ–≤
    async function loadAllProjects() {
      try {
        const response = await fetch('data/projects.json');
        allProjects = await response.json();
        
        // –ì–µ–Ω–µ—Ä—É—î–º–æ —Ñ—ñ–ª—å—Ç—Ä–∏ –ø–æ —Ç–µ–≥–∞—Ö
        generateTagFilters();
        
        // –ü–æ–∫–∞–∑—É—î–º–æ –ø—Ä–æ—î–∫—Ç–∏
        displayProjects();
        
        // –ü—ñ–¥–∫–ª—é—á–∞—î–º–æ –ø–æ—à—É–∫
        setupSearch();
        
      } catch (error) {
        console.error('–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤:', error);
        document.getElementById('projects-grid').innerHTML = `
          <div class="error-message">
            <p>–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–æ—î–∫—Ç–∏</p>
          </div>
        `;
      }
    }
    
    // –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–Ω–æ–ø–æ–∫ —Ñ—ñ–ª—å—Ç—Ä—ñ–≤ –ø–æ —Ç–µ–≥–∞—Ö
    function generateTagFilters() {
      const tags = window.utils.getAllTags(allProjects);
      const container = document.getElementById('filter-tags');
      
      // –ö–Ω–æ–ø–∫–∞ "–í—Å—ñ" –≤–∂–µ —î –≤ HTML
      
      // –î–æ–¥–∞—î–º–æ –∫–Ω–æ–ø–∫–∏ –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ —Ç–µ–≥—É
      tags.forEach(tag => {
        const button = document.createElement('button');
        button.className = 'filter-tag';
        button.dataset.tag = tag;
        button.textContent = tag;
        button.onclick = () => filterByTag(tag);
        container.appendChild(button);
      });
    }
    
    // –§—ñ–ª—å—Ç—Ä–∞—Ü—ñ—è –ø–æ —Ç–µ–≥—É
    function filterByTag(tag) {
      currentTag = tag;
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –∞–∫—Ç–∏–≤–Ω—É –∫–Ω–æ–ø–∫—É
      document.querySelectorAll('.filter-tag').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tag === tag);
      });
      
      displayProjects();
    }
    
    
    // –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –ø–æ—à—É–∫—É
	function setupSearch() {
	const searchInput = document.getElementById('search-input');
  
	// –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ debounce –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó
	const debouncedSearch = window.utils.debounce((query) => {
    currentSearch = query;
    
    // –Ø–∫—â–æ —î –ø–æ—à—É–∫–æ–≤–∏–π –∑–∞–ø–∏—Ç ‚Äî —Å–∫–∏–¥–∞—î–º–æ —Ñ—ñ–ª—å—Ç—Ä —Ç–µ–≥—ñ–≤ –Ω–∞ "–í—Å—ñ"
    if (query.trim() !== '') {
      currentTag = 'all';
      document.querySelectorAll('.filter-tag').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.tag === 'all');
      });
    }
    
    displayProjects();
  }, 300);
  
  searchInput.addEventListener('input', (e) => {
    debouncedSearch(e.target.value);
  });
}
    
    // –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—î–∫—Ç—ñ–≤ –∑ —Ñ—ñ–ª—å—Ç—Ä–∞—Ü—ñ—î—é
    function displayProjects() {
      const grid = document.getElementById('projects-grid');
      const noResults = document.getElementById('no-results');
      const resultsCount = document.getElementById('results-count');
      
      // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –ø–æ —Ç–µ–≥—É
      let filteredProjects = currentTag === 'all' 
        ? allProjects 
        : window.utils.filterByTag(allProjects, currentTag);
      
      // –§—ñ–ª—å—Ç—Ä—É—î–º–æ –ø–æ –ø–æ—à—É–∫–æ–≤–æ–º—É –∑–∞–ø–∏—Ç—É
      if (currentSearch) {
        filteredProjects = window.utils.searchItems(
          filteredProjects, 
          currentSearch,
          ['title', 'description', 'tags', 'role']
        );
      }
      
      // –û–Ω–æ–≤–ª—é—î–º–æ –ª—ñ—á–∏–ª—å–Ω–∏–∫
      resultsCount.textContent = filteredProjects.length;
      
      // –Ø–∫—â–æ –Ω—ñ—á–æ–≥–æ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ
      if (filteredProjects.length === 0) {
        grid.style.display = 'none';
        noResults.style.display = 'block';
        return;
      }
      
      // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
      grid.style.display = 'grid';
      noResults.style.display = 'none';
      grid.innerHTML = '';
      
      filteredProjects.forEach(project => {
        const card = document.createElement('a');
        card.className = 'card';
        card.href = `project.html?project=${project.slug}`;
        
        card.innerHTML = `
          ${project.thumbnail ? 
            `<div class="thumb" style="background-image: url('${project.thumbnail}'); background-size: cover; background-position: center;"></div>` :
            `<div class="thumb"></div>`
          }
          <div class="card-body">
            <h3>${highlightText(project.title, currentSearch)}</h3>
            <div class="meta">${project.role}</div>
            <p style="margin: 8px 0 0; color: var(--muted); font-size: 14px;">
              ${highlightText(project.description, currentSearch)}
            </p>
            ${project.tags && project.tags.length > 0 ? 
              `<div class="tags" style="margin-top: 12px;">
                ${project.tags.slice(0, 3).map(tag => `<span class="chip">#${tag}</span>`).join(' ')}
              </div>` : 
              ''
            }
          </div>
        `;
        
        grid.appendChild(card);
      });
    }
    
    // –ü—ñ–¥—Å–≤—ñ—á—É–≤–∞–Ω–Ω—è –∑–Ω–∞–π–¥–µ–Ω–æ–≥–æ —Ç–µ–∫—Å—Ç—É
    function highlightText(text, query) {
      if (!query || query.trim() === '') return text;
      
      const regex = new RegExp(`(${query})`, 'gi');
      return text.replace(regex, '<mark>$1</mark>');
    }
    
    // –ó–∞–ø—É—Å–∫
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', loadAllProjects);
    } else {
      loadAllProjects();
    }
  </script>
</body>
</html>